<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<link rel="import" href="../../polymer/polymer.html">
<link rel="import" href="../../paper-card/paper-card.html">
<link rel="import" href="../../paper-button/paper-button.html">
<link rel="import" href="../../paper-input/paper-input.html">
<link rel="import" href="../../saint-dropdown-menu/saint-dropdown-menu.html">
<link rel="import" href="../../saint-datepicker/saint-datepicker.html">
<link rel="import" href="../../iron-flex-layout/iron-flex-layout-classes.html">
<script src="../../jquery/dist/jquery.min.js"></script>
<!--
Example:

    <template is="dom-bind" id="app">
      
      <saint-edit-item-card
        id="edit"
        on-confirm="onConfirm">

        <saint-edit-item
          name="name"
          type="text"
          value="テスト"
          label="名前">
        </saint-edit-item>

        <saint-edit-item 
          name="birthday"
          type="date"
          value="1984-04-02"
          label="誕生日">
        </saint-edit-item>

        <saint-edit-item 
          name="area"
          type="list"
          list$="{{areas}}"
          value="1"
          label="居住地">
        </saint-edit-item>

      </saint-edit-item-card>
    </template>
    <script>
      var app = document.querySelector('#app');
      app.areas = ['東京', '京都', '大坂'];
      app.onConfirm = function(event) {
        var result = event.detail.result;
        alert(JSON.stringify(result));
      };
    </script>

@demo
-->
<dom-module id="saint-edit-item-card">

  <style is="custom-style" include="iron-flex iron-flex-alignment">
    :host {

    }
    paper-card#container {
      width: 100%;
      @apply(--saint-edit-item-card-container);
    }

    .edit-button {
      position: absolute;
      top: 4px;
      right: 0px;
      padding: 8px;
      font-size: 12px;
      color: var(--paper-blue-300);
    }
    .card-actions {
      display: none;
    }

    @media (max-width: 600px) {
      .card-content {
        padding: 4px;
      }
    }
  </style>

  <template>
    <paper-card
      id="container"
      heading="ユーザー情報">
      <paper-button
        class="private-menu edit-button toggle-item"
        on-click="_toggle">
        {{editLabel}}
      </paper-button>
      <div class="card-content">
        <content></content>
      </div>
      <div class="card-actions toggle-item">
        <paper-button on-click="_onClickConfirm">OK</paper-button>
        <paper-button on-click="_onClickCancel">CANCEL</paper-button>
      </div>
    </paper-card>
  </template>

</dom-module>

<script>
  Polymer({
    is: 'saint-edit-item-card',
    properties: {
      editLabel: {
        type: String,
        value: 'edit'
      },
    },
    // Element Lifecycle
    ready: function() {
      
    },
    cancel: function() {
      var items = this.querySelectorAll('saint-edit-item');
      for (var i = 0; i < items.length; i++) {
        items[i].cancel();
      }
    },
    _onClickConfirm: function(evnet) {
      this._togglecurr();
      var items = this.querySelectorAll('saint-edit-item');
      var results = [];
      for (var i = 0; i < items.length; i++) {
        var result = items[i].save();
        results = results.concat(result);
      }
      this.fire('confirm', {result: results});
    },
    _onClickCancel: function(event) {
      this._togglecurr();
      this.cancel();
    },
    _toggle: function(event) {
      this._togglecurr();
      var items = this.querySelectorAll('saint-edit-item');
      for (var i = 0; i < items.length; i++) {
        items[i].toggle();
      }
    },
    _togglecurr: function() {
      var toggle = this.querySelectorAll('.toggle-item');
      $(toggle).toggle();
    }
  });

</script>
